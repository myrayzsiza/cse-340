<%# Unit 3, Build Classification View activity %>
<% if (title) { %>
<h1><%= title %> </h1>
<% } else {
  res.redirect('/')
} %>

<%# messages() %>

<%- grid %>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Handle order button clicks
  document.addEventListener('click', function(e) {
    if (e.target.classList.contains('order-btn')) {
      const isSignedIn = <%= typeof locals.accountData !== 'undefined' && locals.accountData ? 'true' : 'false' %>;
      const vehicleId = e.target.getAttribute('data-vehicle-id');
      
      if (isSignedIn === 'false') {
        showSignInModal();
      } else {
        // Redirect to checkout page
        window.location.href = `/order/checkout/${vehicleId}`;
      }
    }
  });

  // Show sign-in modal/prompt
  function showSignInModal() {
    const signInChoice = confirm('You must be signed in to order a vehicle. Would you like to sign in now?');
    if (signInChoice) {
      window.location.href = '/account/login';
    }
  }
});
</script>